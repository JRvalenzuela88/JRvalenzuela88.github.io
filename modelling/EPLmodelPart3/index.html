



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Documentation, guides and articles on creating, developing and implementing automated betting strategies, using data analysis to inform betting models and how to interact with the Betfair API.">
      
      
        <link rel="canonical" href="https://betfair-datascientists.github.io/modelling/EPLmodelPart3/">
      
      
        <meta name="author" content="Betfair Data Scientists">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../img/BetfairFavicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.0.4">
    
    
      
        <title>EPL 03. Model building & hyperparameter tuning - The Automation Hub</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.834e7605.css">
      
      
    
    
      <script src="../../assets/javascripts/modernizr.dd00d4b7.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    <link rel="stylesheet" href="../../assets/fonts/clarke-regular.css">
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="../../#epl-machine-learning-walkthrough" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://betfair-datascientists.github.io" title="The Automation Hub" class="md-header-nav__button md-logo">
          
            <img src="../../img/logo.svg" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                The Automation Hub
              </span>
              <span class="md-header-nav__topic">
                EPL 03. Model building & hyperparameter tuning
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      <div class="bf-nav md-flex__cell">
        <a class="bf-hidable" href="https://www.betfair.com.au/exchange/plus/"><svg class="exchangeLogo" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 38.775 4.59" width="24" height="17">
          <path class="st1" d="m 160.3,-136.95 v 26"/>
          <g transform="translate(18.8,-137.15)">
            <path d="m 2.2901089,126.53441 v 5.20093 H -3.3107216 L 7.4888397,144.33446 18.2884,131.73534 h -5.598633 v -5.20093 z m -8.6000974,8.10132 -10.8017585,12.59913 h 5.60083 v 5.2998 h 10.3996581 v -5.2998 h 5.6008306 z"/>
          </g>
        </svg><span> Exchange</span></a>
        <a href="https://www.betfair.com.au/hub/">Hub</a>
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="Home" class="md-tabs__link">
          Home
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../thirdPartyTools/overview/" title="Tutorials" class="md-tabs__link">
          Tutorials
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../api/apiappkey/" title="API" class="md-tabs__link">
          API
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../historicData/dataSources/" title="Historic Data" class="md-tabs__link">
          Historic Data
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../howToModel/" title="Modelling" class="md-tabs__link md-tabs__link--active">
          Modelling
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://betfair-datascientists.github.io" title="The Automation Hub" class="md-nav__button md-logo">
      
        <img src="../../img/logo.svg" width="48" height="48">
      
    </a>
    The Automation Hub
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      Home
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        Home
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../.." title="The Automation Hub" class="md-nav__link">
      The Automation Hub
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../thirdPartyTools/overview/" title="Tools Overview" class="md-nav__link">
      Tools Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-2" type="checkbox" id="nav-2-2">
    
    <label class="md-nav__link" for="nav-2-2">
      Bet Angel Professional
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-2">
        Bet Angel Professional
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../thirdPartyTools/betAngel/betAngel/" title="Overview - Bet Angel Pro" class="md-nav__link">
      Overview - Bet Angel Pro
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../thirdPartyTools/betAngelbeginners/" title="Bet Angel - A beginner's guide" class="md-nav__link">
      Bet Angel - A beginner's guide
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../thirdPartyTools/betAngelintermediate/" title="Bet Angel - An intermediate guide" class="md-nav__link">
      Bet Angel - An intermediate guide
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../thirdPartyTools/betAngeladvanced/" title="Bet Angel - An advanced guide" class="md-nav__link">
      Bet Angel - An advanced guide
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../thirdPartyTools/betAngelRatingsAutomation/" title="Ratings automation" class="md-nav__link">
      Ratings automation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../thirdPartyTools/betAngelMarketFavouriteAutomation/" title="Market favourite automation" class="md-nav__link">
      Market favourite automation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../thirdPartyTools/betAngelTippingAutomation/" title="Tipping automation" class="md-nav__link">
      Tipping automation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../thirdPartyTools/betAngelSimultaneousMarkets/" title="Simultaneous markets" class="md-nav__link">
      Simultaneous markets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../thirdPartyTools/betAngelKellyStake/" title="Kelly Criterion staking" class="md-nav__link">
      Kelly Criterion staking
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-3" type="checkbox" id="nav-2-3">
    
    <label class="md-nav__link" for="nav-2-3">
      Gruss Betting Assistant
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-3">
        Gruss Betting Assistant
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../thirdPartyTools/Gruss/Gruss/" title="Overview - Gruss" class="md-nav__link">
      Overview - Gruss
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../thirdPartyTools/grussRatingsAutomation/" title="Ratings automation" class="md-nav__link">
      Ratings automation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../thirdPartyTools/grussMarketFavouriteAutomation/" title="Market favourite automation" class="md-nav__link">
      Market favourite automation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../thirdPartyTools/grusslSimultaneousMarkets/" title="Simultaneous markets" class="md-nav__link">
      Simultaneous markets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../thirdPartyTools/grussKellyStake/" title="Kelly Criterion staking" class="md-nav__link">
      Kelly Criterion staking
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-4" type="checkbox" id="nav-2-4">
    
    <label class="md-nav__link" for="nav-2-4">
      Cymatic Trader
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-4">
        Cymatic Trader
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../thirdPartyTools/CymaticTrader/CymaticTrader/" title="Overview - Cymatic Trader" class="md-nav__link">
      Overview - Cymatic Trader
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../thirdPartyTools/cymaticTraderRatingsAutomation/" title="Ratings automation" class="md-nav__link">
      Ratings automation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      API
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        API
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../api/apiappkey/" title="How to access the Betfair API" class="md-nav__link">
      How to access the Betfair API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../api/apiRtutorial/" title="API tutorials in R" class="md-nav__link">
      API tutorials in R
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../api/apiPythontutorial/" title="API tutorial in Python" class="md-nav__link">
      API tutorial in Python
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Historic Data
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Historic Data
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../historicData/dataSources/" title="Historic Data Sources" class="md-nav__link">
      Historic Data Sources
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../historicData/usingHistoricDataSite/" title="Downloading from the Historic Data site" class="md-nav__link">
      Downloading from the Historic Data site
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" checked>
    
    <label class="md-nav__link" for="nav-5">
      Modelling
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Modelling
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../howToModel/" title="Intro to modelling" class="md-nav__link">
      Intro to modelling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../howToModelTheAusOpen/" title="How to model the Australian Open" class="md-nav__link">
      How to model the Australian Open
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../AusOpenRTutorial/" title="Aus Open R Tutorial" class="md-nav__link">
      Aus Open R Tutorial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../AusOpenPythonTutorial/" title="Aus Open Python Tutorial" class="md-nav__link">
      Aus Open Python Tutorial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../EPLmodelPart1/" title="EPL 01. Data acquisition & exploration" class="md-nav__link">
      EPL 01. Data acquisition & exploration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../EPLmodelPart2/" title="EPL 02. Data preparation & feature engineering" class="md-nav__link">
      EPL 02. Data preparation & feature engineering
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
    <a href="./" title="EPL 03. Model building & hyperparameter tuning" class="md-nav__link md-nav__link--active">
      EPL 03. Model building & hyperparameter tuning
    </a>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../EPLmodelPart4/" title="EPL 04. Weekly predictions" class="md-nav__link">
      EPL 04. Weekly predictions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../AFLmodelPart1/" title="AFL 01. Data cleaning" class="md-nav__link">
      AFL 01. Data cleaning
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../AFLmodelPart2/" title="AFL 02. Feature creation" class="md-nav__link">
      AFL 02. Feature creation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../AFLmodelPart3/" title="AFL 03. Modelling" class="md-nav__link">
      AFL 03. Modelling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../AFLmodelPart4/" title="AFL 04. Weekly predictions" class="md-nav__link">
      AFL 04. Weekly predictions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../brownlowModelTutorial/" title="Modelling the Brownlow Medal" class="md-nav__link">
      Modelling the Brownlow Medal
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="epl-machine-learning-walkthrough">EPL Machine Learning Walkthrough<a class="headerlink" href="#epl-machine-learning-walkthrough" title="Permanent link">&para;</a></h1>
<h1 id="03-model-building-hyperparameter-tuning">03. Model Building &amp; Hyperparameter Tuning<a class="headerlink" href="#03-model-building-hyperparameter-tuning" title="Permanent link">&para;</a></h1>
<p>Welcome to the third part of this Machine Learning Walkthrough. This tutorial will focus on the model building process, including how to tune hyperparameters. In the [next tutorial], we will create weekly predictions based on the model we have created here.</p>
<p>Specifically, this tutorial will cover a few things:</p>
<ol>
<li>Choosing which Machine Learning algorithm to use from a variety of choices</li>
<li>Hyperparameter Tuning</li>
<li>Overfitting/Underfitting</li>
</ol>
<hr />
<h2 id="choosing-an-algorithm">Choosing an Algorithm<a class="headerlink" href="#choosing-an-algorithm" title="Permanent link">&para;</a></h2>
<p>The best way to decide on specific algorithm to use, is to try them all! To do this, we will define a function which we first used in our AFL Predictions tutorial. This will iterate over a number of algorithms and give us a good indication of which algorithms are suited for this dataset and exercise.</p>
<p>Let's first use grab the features we created in the last tutorial. This may take a minute or two to run.</p>
<div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #408080; font-style: italic">## Import libraries</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">data_preparation_functions</span> <span style="color: #008000; font-weight: bold">import</span> <span style="color: #666666">*</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">pandas</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">pd</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">np</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">matplotlib</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">plt</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">seaborn</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">sns</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">warnings</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sklearn</span> <span style="color: #008000; font-weight: bold">import</span> linear_model, tree, discriminant_analysis, naive_bayes, ensemble, gaussian_process
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sklearn.linear_model</span> <span style="color: #008000; font-weight: bold">import</span> LogisticRegression
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sklearn.preprocessing</span> <span style="color: #008000; font-weight: bold">import</span> LabelEncoder
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sklearn.model_selection</span> <span style="color: #008000; font-weight: bold">import</span> StratifiedKFold, cross_val_score, GridSearchCV
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sklearn.metrics</span> <span style="color: #008000; font-weight: bold">import</span> log_loss, confusion_matrix
warnings<span style="color: #666666">.</span>filterwarnings(<span style="color: #BA2121">&#39;ignore&#39;</span>)
pd<span style="color: #666666">.</span>set_option(<span style="color: #BA2121">&#39;display.max_columns&#39;</span>, <span style="color: #666666">100</span>)
</pre></div>

<div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>features <span style="color: #666666">=</span> create_feature_df()
    Creating <span style="color: #008000">all</span> games feature DataFrame
    Creating stats feature DataFrame
    Creating odds feature DataFrame
    Creating market values feature DataFrame
    Filling NAs
    Merging stats, odds <span style="color: #AA22FF; font-weight: bold">and</span> market values into one features DataFrame
    Complete<span style="color: #666666">.</span>
</pre></div>

<p>To start our modelling process, we need to make a training set, a test set and a holdout set. As we are using cross validation, we will make our training set all of the seasons up until 2017/18, and we will use the 2017/18 season as the test set.</p>
<div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>feature_list <span style="color: #666666">=</span> [col <span style="color: #008000; font-weight: bold">for</span> col <span style="color: #AA22FF; font-weight: bold">in</span> features<span style="color: #666666">.</span>columns <span style="color: #008000; font-weight: bold">if</span> col<span style="color: #666666">.</span>startswith(<span style="color: #BA2121">&quot;f_&quot;</span>)]
betting_features <span style="color: #666666">=</span> []

le <span style="color: #666666">=</span> LabelEncoder() <span style="color: #408080; font-style: italic"># Initiate a label encoder to transform the labels &#39;away&#39;, &#39;draw&#39;, &#39;home&#39; to 0, 1, 2</span>

<span style="color: #408080; font-style: italic"># Grab all seasons except for 17/18 to use CV with</span>
all_x <span style="color: #666666">=</span> features<span style="color: #666666">.</span>loc[features<span style="color: #666666">.</span>season <span style="color: #666666">!=</span> <span style="color: #BA2121">&#39;1718&#39;</span>, [<span style="color: #BA2121">&#39;gameId&#39;</span>] <span style="color: #666666">+</span> feature_list]
all_y <span style="color: #666666">=</span> features<span style="color: #666666">.</span>loc[features<span style="color: #666666">.</span>season <span style="color: #666666">!=</span> <span style="color: #BA2121">&#39;1718&#39;</span>, <span style="color: #BA2121">&#39;result&#39;</span>]
all_y <span style="color: #666666">=</span> le<span style="color: #666666">.</span>fit_transform(all_y)

<span style="color: #408080; font-style: italic"># Create our training vector as the seasons except 16/17 and 17/18</span>
train_x <span style="color: #666666">=</span> features<span style="color: #666666">.</span>loc[<span style="color: #666666">~</span>features<span style="color: #666666">.</span>season<span style="color: #666666">.</span>isin([<span style="color: #BA2121">&#39;1617&#39;</span>, <span style="color: #BA2121">&#39;1718&#39;</span>]), [<span style="color: #BA2121">&#39;gameId&#39;</span>] <span style="color: #666666">+</span> feature_list]
train_y <span style="color: #666666">=</span> le<span style="color: #666666">.</span>transform(features<span style="color: #666666">.</span>loc[<span style="color: #666666">~</span>features<span style="color: #666666">.</span>season<span style="color: #666666">.</span>isin([<span style="color: #BA2121">&#39;1617&#39;</span>, <span style="color: #BA2121">&#39;1718&#39;</span>]), <span style="color: #BA2121">&#39;result&#39;</span>])

<span style="color: #408080; font-style: italic"># Create our holdout vectors as the 16/17 season</span>
holdout_x <span style="color: #666666">=</span> features<span style="color: #666666">.</span>loc[features<span style="color: #666666">.</span>season <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;1617&#39;</span>, [<span style="color: #BA2121">&#39;gameId&#39;</span>] <span style="color: #666666">+</span> feature_list]
holdout_y <span style="color: #666666">=</span> le<span style="color: #666666">.</span>transform(features<span style="color: #666666">.</span>loc[features<span style="color: #666666">.</span>season <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;1617&#39;</span>, <span style="color: #BA2121">&#39;result&#39;</span>])

<span style="color: #408080; font-style: italic"># Create our test vectors as the 17/18 season</span>
test_x <span style="color: #666666">=</span> features<span style="color: #666666">.</span>loc[features<span style="color: #666666">.</span>season <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;1718&#39;</span>, [<span style="color: #BA2121">&#39;gameId&#39;</span>] <span style="color: #666666">+</span> feature_list]
test_y <span style="color: #666666">=</span> le<span style="color: #666666">.</span>transform(features<span style="color: #666666">.</span>loc[features<span style="color: #666666">.</span>season <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;1718&#39;</span>, <span style="color: #BA2121">&#39;result&#39;</span>])
</pre></div>

<div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #408080; font-style: italic"># Create a list of standard classifiers</span>
classifiers <span style="color: #666666">=</span> [

    <span style="color: #408080; font-style: italic">#GLM</span>
    linear_model<span style="color: #666666">.</span>LogisticRegressionCV(),

    <span style="color: #408080; font-style: italic">#Navies Bayes</span>
    naive_bayes<span style="color: #666666">.</span>BernoulliNB(),
    naive_bayes<span style="color: #666666">.</span>GaussianNB(),

    <span style="color: #408080; font-style: italic">#Discriminant Analysis</span>
    discriminant_analysis<span style="color: #666666">.</span>LinearDiscriminantAnalysis(),
    discriminant_analysis<span style="color: #666666">.</span>QuadraticDiscriminantAnalysis(),

    <span style="color: #408080; font-style: italic">#Ensemble Methods</span>
    ensemble<span style="color: #666666">.</span>AdaBoostClassifier(),
    ensemble<span style="color: #666666">.</span>BaggingClassifier(),
    ensemble<span style="color: #666666">.</span>ExtraTreesClassifier(),
    ensemble<span style="color: #666666">.</span>GradientBoostingClassifier(),
    ensemble<span style="color: #666666">.</span>RandomForestClassifier(),

    <span style="color: #408080; font-style: italic">#Gaussian Processes</span>
    gaussian_process<span style="color: #666666">.</span>GaussianProcessClassifier(),

    <span style="color: #408080; font-style: italic">#xgboost: http://xgboost.readthedocs.io/en/latest/model.html</span>
<span style="color: #408080; font-style: italic">#     xgb.XGBClassifier()    </span>
]
</pre></div>

<div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">find_best_algorithms</span>(classifier_list, X, y):
    <span style="color: #408080; font-style: italic"># This function is adapted from https://www.kaggle.com/yassineghouzam/titanic-top-4-with-ensemble-modeling</span>
    <span style="color: #408080; font-style: italic"># Cross validate model with Kfold stratified cross validation</span>
    kfold <span style="color: #666666">=</span> StratifiedKFold(n_splits<span style="color: #666666">=5</span>)

    <span style="color: #408080; font-style: italic"># Grab the cross validation scores for each algorithm</span>
    cv_results <span style="color: #666666">=</span> [cross_val_score(classifier, X, y, scoring <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;neg_log_loss&quot;</span>, cv <span style="color: #666666">=</span> kfold) <span style="color: #008000; font-weight: bold">for</span> classifier <span style="color: #AA22FF; font-weight: bold">in</span> classifier_list]
    cv_means <span style="color: #666666">=</span> [cv_result<span style="color: #666666">.</span>mean() <span style="color: #666666">*</span> <span style="color: #666666">-1</span> <span style="color: #008000; font-weight: bold">for</span> cv_result <span style="color: #AA22FF; font-weight: bold">in</span> cv_results]
    cv_std <span style="color: #666666">=</span> [cv_result<span style="color: #666666">.</span>std() <span style="color: #008000; font-weight: bold">for</span> cv_result <span style="color: #AA22FF; font-weight: bold">in</span> cv_results]
    algorithm_names <span style="color: #666666">=</span> [alg<span style="color: #666666">.</span><span style="color: #19177C">__class__</span><span style="color: #666666">.</span><span style="color: #19177C">__name__</span> <span style="color: #008000; font-weight: bold">for</span> alg <span style="color: #AA22FF; font-weight: bold">in</span> classifiers]

    <span style="color: #408080; font-style: italic"># Create a DataFrame of all the CV results</span>
    cv_results <span style="color: #666666">=</span> pd<span style="color: #666666">.</span>DataFrame({
        <span style="color: #BA2121">&quot;Mean Log Loss&quot;</span>: cv_means,
        <span style="color: #BA2121">&quot;Log Loss Std&quot;</span>: cv_std,
        <span style="color: #BA2121">&quot;Algorithm&quot;</span>: algorithm_names
    })<span style="color: #666666">.</span>sort_values(by<span style="color: #666666">=</span><span style="color: #BA2121">&#39;Mean Log Loss&#39;</span>)
    <span style="color: #008000; font-weight: bold">return</span> cv_results
</pre></div>

<div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>algorithm_results <span style="color: #666666">=</span> find_best_algorithms(classifiers, all_x, all_y)
</pre></div>

<div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>algorithm_results
</pre></div>

<table>
<thead>
<tr>
<th></th>
<th>Mean Log Loss</th>
<th>Log Loss Std</th>
<th>Algorithm</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>0.966540</td>
<td>0.020347</td>
<td>LogisticRegressionCV</td>
</tr>
<tr>
<td>3</td>
<td>0.986679</td>
<td>0.015601</td>
<td>LinearDiscriminantAnalysis</td>
</tr>
<tr>
<td>1</td>
<td>1.015197</td>
<td>0.017466</td>
<td>BernoulliNB</td>
</tr>
<tr>
<td>10</td>
<td>1.098612</td>
<td>0.000000</td>
<td>GaussianProcessClassifier</td>
</tr>
<tr>
<td>5</td>
<td>1.101281</td>
<td>0.044383</td>
<td>AdaBoostClassifier</td>
</tr>
<tr>
<td>8</td>
<td>1.137778</td>
<td>0.153391</td>
<td>GradientBoostingClassifier</td>
</tr>
<tr>
<td>7</td>
<td>2.093981</td>
<td>0.284831</td>
<td>ExtraTreesClassifier</td>
</tr>
<tr>
<td>9</td>
<td>2.095088</td>
<td>0.130367</td>
<td>RandomForestClassifier</td>
</tr>
<tr>
<td>6</td>
<td>2.120571</td>
<td>0.503132</td>
<td>BaggingClassifier</td>
</tr>
<tr>
<td>4</td>
<td>4.065796</td>
<td>1.370119</td>
<td>QuadraticDiscriminantAnalysis</td>
</tr>
<tr>
<td>2</td>
<td>5.284171</td>
<td>0.826991</td>
<td>GaussianNB</td>
</tr>
</tbody>
</table>
<p>We can see that LogisticRegression seems to perform the best out of all the algorithms, and some algorithms have a very high log loss. This is most likely due to overfitting. It would definitely be useful to condense our features down to reduce the dimensionality of the dataset.</p>
<hr />
<h2 id="hyperparameter-tuning">Hyperparameter Tuning<a class="headerlink" href="#hyperparameter-tuning" title="Permanent link">&para;</a></h2>
<p>For now, however, we will use logistic regression. Let's first try and tune a logistic regression model with cross validation. To do this, we will use <a href="https://en.wikipedia.org/wiki/Hyperparameter_optimization">grid search</a>. Grid search essentially tries out each combination of values and finds the model with the lowest error metric, which in our case is log loss. 'C' in logistic regression determines the amount of regularization. Lower values increase regularization.</p>
<div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #408080; font-style: italic"># Define our parameters to run a grid search over</span>
lr_grid <span style="color: #666666">=</span> {
    <span style="color: #BA2121">&quot;C&quot;</span>: [<span style="color: #666666">0.0001</span>, <span style="color: #666666">0.01</span>, <span style="color: #666666">0.05</span>, <span style="color: #666666">0.2</span>, <span style="color: #666666">1</span>],
    <span style="color: #BA2121">&quot;solver&quot;</span>: [<span style="color: #BA2121">&quot;newton-cg&quot;</span>, <span style="color: #BA2121">&quot;lbfgs&quot;</span>, <span style="color: #BA2121">&quot;liblinear&quot;</span>]
}

kfold <span style="color: #666666">=</span> StratifiedKFold(n_splits<span style="color: #666666">=5</span>)

gs <span style="color: #666666">=</span> GridSearchCV(LogisticRegression(), param_grid<span style="color: #666666">=</span>lr_grid, cv<span style="color: #666666">=</span>kfold, scoring<span style="color: #666666">=</span><span style="color: #BA2121">&#39;neg_log_loss&#39;</span>)
gs<span style="color: #666666">.</span>fit(all_x, all_y)
<span style="color: #008000; font-weight: bold">print</span>(<span style="color: #BA2121">&quot;Best log loss: {}&quot;</span><span style="color: #666666">.</span>format(gs<span style="color: #666666">.</span>best_score_ <span style="color: #666666">*-1</span>))
best_lr_params <span style="color: #666666">=</span> gs<span style="color: #666666">.</span>best_params_

  Best log loss: <span style="color: #666666">0.9669551970849734</span>
</pre></div>

<hr />
<h2 id="defining-a-baseline">Defining a Baseline<a class="headerlink" href="#defining-a-baseline" title="Permanent link">&para;</a></h2>
<p>We should also define a baseline, as we don't really know if our log loss is good or bad. Randomly assigning a &#8531; chance to each selection yields a log loss of log3 = 1.09. However, what we are really interested in, is how our model performs relative to the odds. So let's find the log loss of the odds.</p>
<div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #408080; font-style: italic"># Finding the log loss of the odds</span>
log_loss(all_y, <span style="color: #666666">1</span> <span style="color: #666666">/</span> all_x[[<span style="color: #BA2121">&#39;f_awayOdds&#39;</span>, <span style="color: #BA2121">&#39;f_drawOdds&#39;</span>, <span style="color: #BA2121">&#39;f_homeOdds&#39;</span>]])

  <span style="color: #666666">0.9590114943474463</span>
</pre></div>

<p>This is good news: our algorithm almost beats the bookies in terms of log loss. It would be great if we could beat this result.</p>
<hr />
<h2 id="analysing-the-errors-made">Analysing the Errors Made<a class="headerlink" href="#analysing-the-errors-made" title="Permanent link">&para;</a></h2>
<p>Now that we have a logistic regression model tuned, let's see what type of errors it made. To do this we will look at the confusion matrix produced when we predict our holdout set.</p>
<div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>lr <span style="color: #666666">=</span> LogisticRegression(<span style="color: #666666">**</span>best_lr_params) <span style="color: #408080; font-style: italic"># Instantiate the model</span>
lr<span style="color: #666666">.</span>fit(train_x, train_y) <span style="color: #408080; font-style: italic"># Fit our model</span>
lr_predict <span style="color: #666666">=</span> lr<span style="color: #666666">.</span>predict(holdout_x) <span style="color: #408080; font-style: italic"># Predict the holdout values</span>
</pre></div>

<div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #408080; font-style: italic"># Create a confusion matrix</span>
c_matrix <span style="color: #666666">=</span> (pd<span style="color: #666666">.</span>DataFrame(confusion_matrix(holdout_y, lr_predict), columns<span style="color: #666666">=</span>le<span style="color: #666666">.</span>classes_, index<span style="color: #666666">=</span>le<span style="color: #666666">.</span>classes_)
 <span style="color: #666666">.</span>rename_axis(<span style="color: #BA2121">&#39;Actual&#39;</span>)
 <span style="color: #666666">.</span>rename_axis(<span style="color: #BA2121">&#39;Predicted&#39;</span>, axis<span style="color: #666666">=</span><span style="color: #BA2121">&#39;columns&#39;</span>))

c_matrix
</pre></div>

<table>
<thead>
<tr>
<th>Predicted</th>
<th>away</th>
<th>draw</th>
<th>home</th>
</tr>
</thead>
<tbody>
<tr>
<td>Actual</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>away</td>
<td>77</td>
<td>0</td>
<td>32</td>
</tr>
<tr>
<td>draw</td>
<td>26</td>
<td>3</td>
<td>55</td>
</tr>
<tr>
<td>home</td>
<td>33</td>
<td>7</td>
<td>147</td>
</tr>
</tbody>
</table>
<p>As we can see, when we predicted 'away' as the result, we correctly predicted 79 / 109 results, a hit rate of 70.6%. However, when we look at our draw hit rate, we only predicted 6 / 84 correctly, meaning we only had a hit rate of around 8.3%. For a more in depth analysis of our predictions, please skip to the Analysing Predictions &amp; Staking Strategies section of the tutorial.</p>
<p>Before we move on, however, let's use our model to predict the 17/18 season and compare how we went with the odds.</p>
<p><div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #408080; font-style: italic"># Get test predictions</span>

test_lr <span style="color: #666666">=</span> LogisticRegression(<span style="color: #666666">**</span>best_lr_params)
test_lr<span style="color: #666666">.</span>fit(all_x, all_y)
test_predictions_probs <span style="color: #666666">=</span> lr<span style="color: #666666">.</span>predict_proba(test_x)
test_predictions <span style="color: #666666">=</span> lr<span style="color: #666666">.</span>predict(test_x)

test_ll <span style="color: #666666">=</span> log_loss(test_y, test_predictions_probs)
test_accuracy <span style="color: #666666">=</span> (test_predictions <span style="color: #666666">==</span> test_y)<span style="color: #666666">.</span>mean()

<span style="color: #008000; font-weight: bold">print</span>(<span style="color: #BA2121">&quot;Our predictions for the 2017/18 season have a log loss of: {0:.5f} and an accuracy of: {1:.2f}&quot;</span><span style="color: #666666">.</span>format(test_ll, test_accuracy))
</pre></div>
    Our predictions for the 2017/18 season have a log loss of: 0.95767 and an accuracy of: 0.56</p>
<p><div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #408080; font-style: italic"># Get accuracy and log loss based on the odds</span>
odds_ll <span style="color: #666666">=</span> log_loss(test_y, <span style="color: #666666">1</span> <span style="color: #666666">/</span> test_x[[<span style="color: #BA2121">&#39;f_awayOdds&#39;</span>, <span style="color: #BA2121">&#39;f_drawOdds&#39;</span>, <span style="color: #BA2121">&#39;f_homeOdds&#39;</span>]])

odds_predictions <span style="color: #666666">=</span> test_x[[<span style="color: #BA2121">&#39;f_awayOdds&#39;</span>, <span style="color: #BA2121">&#39;f_drawOdds&#39;</span>, <span style="color: #BA2121">&#39;f_homeOdds&#39;</span>]]<span style="color: #666666">.</span>apply(<span style="color: #008000; font-weight: bold">lambda</span> row: row<span style="color: #666666">.</span>idxmin()[<span style="color: #666666">2</span>:<span style="color: #666666">6</span>], axis<span style="color: #666666">=1</span>)<span style="color: #666666">.</span>values
odds_accuracy <span style="color: #666666">=</span> (odds_predictions <span style="color: #666666">==</span> le<span style="color: #666666">.</span>inverse_transform(test_y))<span style="color: #666666">.</span>mean()

<span style="color: #008000; font-weight: bold">print</span>(<span style="color: #BA2121">&quot;Odds predictions for the 2017/18 season have a log loss of: {0:.5f} and an accuracy of: {1:.3f}&quot;</span><span style="color: #666666">.</span>format(odds_ll, odds_accuracy))
</pre></div>
    Odds predictions for the 2017/18 season have a log loss of: 0.94635 and an accuracy of: 0.545</p>
<hr />
<h2 id="results">Results<a class="headerlink" href="#results" title="Permanent link">&para;</a></h2>
<p>There we have it! The odds predicted 54.5% of EPL games correctly in the 2017/18 season, whilst our model predicted 54% correctly. This is a decent result for the first iteration of our model. In future iterations, we could wait a certain number of matches each season and calculate EMAs for on those first n games. This may help the issue of players switching clubs and teams becoming relatively stronger/weaker compared to previous seasons.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../EPLmodelPart2/" title="EPL 02. Data preparation & feature engineering" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                EPL 02. Data preparation & feature engineering
              </span>
            </div>
          </a>
        
        
          <a href="../EPLmodelPart4/" title="EPL 04. Weekly predictions" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                EPL 04. Weekly predictions
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
      </div>
      
        
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="https://twitter.com/Betfair_Aus" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="https://linkedin.com/company/betfair-australia" class="md-footer-social__link fa fa-linkedin"></a>
    
      <a href="https://facebook.com/betfairaustralia" class="md-footer-social__link fa fa-facebook"></a>
    
      <a href="https://youtube.com/user/betfairaus" class="md-footer-social__link fa fa-youtube"></a>
    
      <a href="https://github.com/betfair-datascientists" class="md-footer-social__link fa fa-github"></a>
    
  </div>

      
    </div>
    <div class="bf-footer">
      <p class="bf-light">Betfair Pty Limited is licensed and regulated by the Northern Territory Government of Australia.</p>
      <p class="bf-dark">Betfair Pty Limited's gambling operations are governed by its Responsible Gambling Code of Conduct and for South
      Australian residents by the South Australian Responsible Gambling Code of Practice.<br> Think! About your choices. Think of the people who need your support. Gamble responsibly. Call Gambling Help 1800 858 858 <a href="https://gamblinghelponline.org.au">www.gamblinghelponline.org.au</a></p>
      <ul class="bf-links">
        <li><a href="https://www.betfair.com.au/hub/help/account-help/responsible-gambling/">Responsible Gambling</a><span>|</span></li>
        <li><a href="http://www.betfair.com/AUS_NZL/aboutUs/Terms.and.Conditions/">Terms & Conditions</a><span>|</span></li>
        <li><a href="https://www.betfair.com.au/info/privacy-policy/">Privacy Policy</a><span>|</span></li>
        <li><a href="http://www.betfair.com/en/aboutUs/Rules.and.Regulations/">Rules & Regulations</a><span>|</span></li>
        <li><a href="https://www.betfair.com/AUS_NZL/aboutUs/Dispute.Resolution">Dispute Resolution</a></li>
      </ul>
    </div>
  </div>
  <script src="https://js.adsrvr.org/up_loader.1.1.0.js"></script>
  <script>ttd_dom_ready(function(){"function"==typeof TTDUniversalPixelApi&&(new TTDUniversalPixelApi).init("y12d1ir",["8ml4f17"],"https://insight.adsrvr.org/track/up")})</script>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.72d6715c.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
        <script src="../../search/main.js"></script>
      
    
    
      
        <script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","UA-125973915-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
      
    
  </body>
</html>